@using Oqtane.Modules.HtmlText.Services
@using Oqtane.Modules
@using Oqtane.Modules.HtmlText.Models
@using System.Net.Http;
@using Oqtane.Modules.Controls
@using Oqtane.Shared;
@namespace Oqtane.Modules.HtmlText
@inherits ModuleBase
@inject NavigationManager NavigationManager
@inject HttpClient http
@inject SiteState sitestate

<ModuleMessage Message="@message" />

@((MarkupString)content)

<br />
<ActionLink Action="Edit" />
<br />
<br />

@code {
    string message = "";
    string content;

    protected override async Task OnParametersSetAsync()
    {
        try
        {
            HtmlTextService htmltextservice = new HtmlTextService(http, sitestate, NavigationManager);
            HtmlTextInfo htmltext = await htmltextservice.GetHtmlTextAsync(ModuleState.ModuleId);
            if (htmltext != null)
            {
                content = htmltext.Content;
            }
        }
        catch (Exception ex)
        {
            message = ex.Message;
        }
    }
}